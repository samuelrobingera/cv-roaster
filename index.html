<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Roast My CV Bot</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf-parse/1.1.1/pdf-parse.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', system-ui, -apple-system, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 40px;
            max-width: 600px;
            width: 100%;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5rem;
            color: #2d3748;
            margin-bottom: 10px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header p {
            color: #718096;
            font-size: 1.1rem;
        }

        .upload-area {
            border: 3px dashed #cbd5e0;
            border-radius: 15px;
            padding: 40px;
            text-align: center;
            margin-bottom: 30px;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .upload-area:hover {
            border-color: #667eea;
            background: rgba(102, 126, 234, 0.05);
            transform: translateY(-2px);
        }

        .upload-area.dragover {
            border-color: #667eea;
            background: rgba(102, 126, 234, 0.1);
            transform: scale(1.02);
        }

        .upload-icon {
            font-size: 3rem;
            color: #a0aec0;
            margin-bottom: 15px;
        }

        .upload-text {
            color: #4a5568;
            font-size: 1.1rem;
            margin-bottom: 10px;
        }

        .upload-subtext {
            color: #a0aec0;
            font-size: 0.9rem;
        }

        #fileInput {
            display: none;
        }

        .api-config {
            background: #f7fafc;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 30px;
        }

        .api-config h3 {
            color: #2d3748;
            margin-bottom: 15px;
            font-size: 1.2rem;
        }

        .input-group {
            margin-bottom: 15px;
        }

        .input-group label {
            display: block;
            color: #4a5568;
            font-weight: 500;
            margin-bottom: 5px;
        }

        .input-group input, .input-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        .input-group input:focus, .input-group select:focus {
            outline: none;
            border-color: #667eea;
        }

        .roast-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 20px;
        }

        .roast-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.3);
        }

        .roast-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .loading {
            display: none;
            text-align: center;
            color: #667eea;
            margin-bottom: 20px;
        }

        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .result {
            display: none;
            background: #f7fafc;
            border-radius: 15px;
            padding: 25px;
            margin-top: 20px;
            border-left: 5px solid #667eea;
        }

        .result h3 {
            color: #2d3748;
            margin-bottom: 15px;
            font-size: 1.3rem;
        }

        .result-content {
            color: #4a5568;
            line-height: 1.6;
            white-space: pre-wrap;
        }

        .error {
            background: #fed7d7;
            border-left-color: #e53e3e;
        }

        .content-type-selection {
            margin-bottom: 30px;
        }

        .content-type-selection h3 {
            color: #2d3748;
            margin-bottom: 15px;
            text-align: center;
            font-size: 1.2rem;
        }

        .type-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
        }

        .type-btn {
            padding: 12px 24px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            background: white;
            color: #4a5568;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .type-btn:hover {
            border-color: #667eea;
            transform: translateY(-2px);
        }

        .type-btn.active {
            border-color: #667eea;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }

        .linkedin-input {
            background: #f7fafc;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 30px;
        }

        .linkedin-input .input-group {
            margin-bottom: 0;
        }

        .help-text {
            font-size: 0.9rem;
            color: #718096;
            margin-top: 5px;
        }
            background: #e6fffa;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
            border-left: 4px solid #38b2ac;
        }

        .features-info h4 {
            color: #234e52;
            margin-bottom: 8px;
            font-size: 1rem;
        }

        .features-info p {
            color: #2c7a7b;
            font-size: 0.9rem;
            line-height: 1.4;
        }

        @media (max-width: 640px) {
            .container {
                padding: 25px;
                margin: 10px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .type-buttons {
                flex-direction: column;
                gap: 10px;
            }
            
            .type-btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ðŸ”¥ Roast My Profile</h1>
            <p>Get brutally honest feedback on your CV or LinkedIn profile</p>
        </div>

        <div class="features-info">
            <h4>âœ¨ Why Use This?</h4>
            <p>AI-powered feedback â€¢ Brutally honest â€¢ Actionable advice for CVs & LinkedIn â€¢ Completely free</p>
        </div>

        <!-- Content Type Selection -->
        <div class="content-type-selection">
            <h3>What would you like to roast?</h3>
            <div class="type-buttons">
                <button class="type-btn active" data-type="cv">ðŸ“„ CV/Resume</button>
                <button class="type-btn" data-type="linkedin">ðŸ’¼ LinkedIn Profile</button>
            </div>
        </div>

        <div class="upload-area" id="uploadArea">
            <div class="upload-icon">ðŸ“„</div>
            <div class="upload-text" id="uploadText">Drop your CV here or click to upload</div>
            <div class="upload-subtext" id="uploadSubtext">Supports PDF, DOCX, TXT files</div>
            <input type="file" id="fileInput" accept=".pdf,.docx,.txt" />
        </div>

        <!-- LinkedIn URL Input (hidden by default) -->
        <div class="linkedin-input" id="linkedinInput" style="display: none;">
            <div class="input-group">
                <label for="linkedinUrl">LinkedIn Profile URL</label>
                <input type="url" id="linkedinUrl" placeholder="https://linkedin.com/in/your-profile" />
                <div class="help-text">Paste your LinkedIn profile URL (make sure it's public)</div>
            </div>
        </div>

        <button class="roast-btn" id="roastBtn" disabled>
            ðŸ”¥ <span id="roastBtnText">Roast My CV</span>
        </button>

        <div class="loading" id="loading">
            <div class="loading-spinner"></div>
            <span id="loadingText">Analyzing with Claude AI...</span>
        </div>

        <div class="result" id="result">
            <h3 id="resultTitle">ðŸŽ¯ The Roast</h3>
            <div class="result-content" id="resultContent"></div>
        </div>
    </div>

    <script>
        class CVRoastBot {
            constructor() {
                this.uploadArea = document.getElementById('uploadArea');
                this.fileInput = document.getElementById('fileInput');
                this.roastBtn = document.getElementById('roastBtn');
                this.roastBtnText = document.getElementById('roastBtnText');
                this.loading = document.getElementById('loading');
                this.result = document.getElementById('result');
                this.resultContent = document.getElementById('resultContent');
                this.resultTitle = document.getElementById('resultTitle');
                this.typeButtons = document.querySelectorAll('.type-btn');
                this.linkedinInput = document.getElementById('linkedinInput');
                this.linkedinUrl = document.getElementById('linkedinUrl');
                this.uploadText = document.getElementById('uploadText');
                this.uploadSubtext = document.getElementById('uploadSubtext');
                
                this.selectedFile = null;
                this.extractedText = '';
                this.currentType = 'cv'; // 'cv' or 'linkedin'
                
                this.initializeEventListeners();
            }

            initializeEventListeners() {
                // Content type selection
                this.typeButtons.forEach(btn => {
                    btn.addEventListener('click', (e) => this.handleTypeChange(e));
                });
                
                // File upload events
                this.uploadArea.addEventListener('click', () => this.fileInput.click());
                this.fileInput.addEventListener('change', (e) => this.handleFileSelect(e));
                
                // Drag and drop events
                this.uploadArea.addEventListener('dragover', (e) => this.handleDragOver(e));
                this.uploadArea.addEventListener('dragleave', (e) => this.handleDragLeave(e));
                this.uploadArea.addEventListener('drop', (e) => this.handleDrop(e));
                
                // LinkedIn URL input
                this.linkedinUrl.addEventListener('input', () => this.validateForm());
                
                // Roast button
                this.roastBtn.addEventListener('click', () => this.roastContent());
                
                // API key validation removed - handled by backend
                this.fileInput.addEventListener('change', (e) => this.handleFileSelect(e));
            }

            handleTypeChange(e) {
                // Remove active class from all buttons
                this.typeButtons.forEach(btn => btn.classList.remove('active'));
                
                // Add active class to clicked button
                e.target.classList.add('active');
                
                // Update current type
                this.currentType = e.target.dataset.type;
                
                // Show/hide appropriate input methods
                if (this.currentType === 'cv') {
                    this.uploadArea.style.display = 'block';
                    this.linkedinInput.style.display = 'none';
                    this.roastBtnText.textContent = 'Roast My CV';
                    
                    // Reset upload area display
                    this.uploadArea.innerHTML = `
                        <div class="upload-icon">ðŸ“„</div>
                        <div class="upload-text">Drop your CV here or click to upload</div>
                        <div class="upload-subtext">Supports PDF, DOCX, TXT files</div>
                        <input type="file" id="fileInput" accept=".pdf,.docx,.txt" />
                    `;
                    // Re-attach file input event listener
                    this.fileInput = document.getElementById('fileInput');
                    this.fileInput.addEventListener('change', (e) => this.handleFileSelect(e));
                    this.uploadArea.addEventListener('click', () => this.fileInput.click());
                } else {
                    this.uploadArea.style.display = 'none';
                    this.linkedinInput.style.display = 'block';
                    this.roastBtnText.textContent = 'Roast My LinkedIn';
                }
                
                // Reset form state
                this.selectedFile = null;
                this.extractedText = '';
                this.linkedinUrl.value = '';
                this.result.style.display = 'none';
                this.validateForm();
            }
                e.preventDefault();
                this.uploadArea.classList.add('dragover');
            }

            handleDragLeave(e) {
                e.preventDefault();
                this.uploadArea.classList.remove('dragover');
            }

            handleDrop(e) {
                e.preventDefault();
                this.uploadArea.classList.remove('dragover');
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    this.handleFile(files[0]);
                }
            }

            handleFileSelect(e) {
                const file = e.target.files[0];
                if (file) {
                    this.handleFile(file);
                }
            }

            async handleFile(file) {
                this.selectedFile = file;
                
                // Update upload area
                this.uploadArea.innerHTML = `
                    <div class="upload-icon">âœ…</div>
                    <div class="upload-text">${file.name}</div>
                    <div class="upload-subtext">File ready for roasting</div>
                `;
                
                // Extract text based on file type
                try {
                    if (file.type === 'application/pdf') {
                        this.extractedText = await this.extractPDFText(file);
                    } else if (file.type.includes('text')) {
                        this.extractedText = await this.extractTextFile(file);
                    } else {
                        // For other file types, we'll use a mock extraction
                        this.extractedText = "Sample CV content extracted from uploaded file.";
                    }
                    
                    this.validateForm();
                } catch (error) {
                    this.showError('Failed to extract text from file. Please try a different format.');
                }
            }

            async extractPDFText(file) {
                // Simplified PDF extraction (in real implementation, use proper PDF library)
                return "Sample CV content: John Doe, Software Engineer with 5 years experience in React, Node.js, and various buzzwords...";
            }

            async extractTextFile(file) {
                return new Promise((resolve, reject) => {
                    const reader = new FileReader();
                    reader.onload = (e) => resolve(e.target.result);
                    reader.onerror = (e) => reject(e);
                    reader.readAsText(file);
                });
            }

            validateForm() {
                if (this.currentType === 'cv') {
                    const hasFile = this.selectedFile !== null;
                    this.roastBtn.disabled = !hasFile;
                } else {
                    const hasLinkedInUrl = this.linkedinUrl.value.trim() !== '' && 
                                         this.linkedinUrl.value.includes('linkedin.com');
                    this.roastBtn.disabled = !hasLinkedInUrl;
                }
            }

            async roastContent() {
                this.showLoading();
                
                try {
                    const roast = await this.callRoastAPI();
                    this.showResult(roast);
                } catch (error) {
                    this.showError(error.message);
                }
            }

            async callRoastAPI() {
                try {
                    if (this.currentType === 'cv') {
                        return await this.callCVRoastAPI();
                    } else {
                        return await this.callLinkedInRoastAPI();
                    }
                } catch (error) {
                    console.error('API Error:', error);
                    throw error;
                }
            }

            async callCVRoastAPI() {
                const formData = new FormData();
                formData.append('file', this.selectedFile);

                const response = await fetch(`${this.getAPIBaseURL()}/api/roast/cv`, {
                    method: 'POST',
                    body: formData,
                });

                if (!response.ok) {
                    const error = await response.json();
                    throw new Error(error.error || 'Failed to process CV');
                }

                const result = await response.json();
                return result.roast;
            }

            async callLinkedInRoastAPI() {
                const linkedinUrl = this.linkedinUrl.value.trim();
                
                const response = await fetch(`${this.getAPIBaseURL()}/api/roast/linkedin`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        url: linkedinUrl
                    }),
                });

                if (!response.ok) {
                    const error = await response.json();
                    throw new Error(error.error || 'Failed to process LinkedIn profile');
                }

                const result = await response.json();
                return result.roast;
            }

            getAPIBaseURL() {
                // In production, this would be your deployed backend URL
                // For development, it would be http://localhost:3001
                return 'https://cv-roaster-api.vercel.app'; // Update this with your actual backend URL
            }

            buildRoastPrompt() {
                return `Act as a brutally honest but ultimately helpful career coach. Roast this CV with humor while providing actionable feedback. Focus on common mistakes like buzzwords, poor formatting, irrelevant details, and missing achievements. Be funny but constructive.

CV Content:
${this.extractedText}

Provide your roast in a conversational, humorous tone with specific examples and actionable advice.`;
            }

            async callOpenAI(apiKey, prompt) {
                const response = await fetch('https://api.openai.com/v1/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${apiKey}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        model: 'gpt-4',
                        messages: [{ role: 'user', content: prompt }],
                        max_tokens: 1000,
                        temperature: 0.8
                    })
                });
                
                if (!response.ok) {
                    throw new Error('OpenAI API call failed. Check your API key.');
                }
                
                const data = await response.json();
                return data.choices[0].message.content;
            }

            async callAnthropic(apiKey, prompt) {
                const response = await fetch('https://api.anthropic.com/v1/messages', {
                    method: 'POST',
                    headers: {
                        'x-api-key': apiKey,
                        'Content-Type': 'application/json',
                        'anthropic-version': '2023-06-01'
                    },
                    body: JSON.stringify({
                        model: 'claude-3-sonnet-20240229',
                        max_tokens: 1000,
                        messages: [{ role: 'user', content: prompt }]
                    })
                });
                
                if (!response.ok) {
                    throw new Error('Anthropic API call failed. Check your API key.');
                }
                
                const data = await response.json();
                return data.content[0].text;
            }

            getMockCVRoast() {
                const roasts = [
                    `ðŸ”¥ OH BOY, where do I even START with this masterpiece?

First off, I see you've mastered the art of buzzword bingo! "Synergistic solutions," "thought leadership," and "paradigm shifts" - did you copy-paste this from a corporate BS generator? 

Your experience section reads like: "Responsible for things. Did stuff. Very important stuff." Be specific! Instead of "managed projects," tell me you "led a 5-person team that increased user engagement by 40%."

And can we talk about that skills section? You listed "Microsoft Office" as a skill in 2024. That's like putting "can breathe oxygen" on your CV. 

BUT here's the good news - I can see potential buried under all this corporate speak. Your actual achievements are solid, they just need to see daylight!

ðŸ’¡ Quick fixes:
- Replace buzzwords with specific metrics
- Use action verbs (led, built, achieved)
- Quantify everything with numbers
- Remove outdated "skills" like basic software
- Add a personal project that shows passion

You're not hopeless, just corporate-washed! ðŸ˜„`,

                    `ðŸŽ¯ Well well well, another "results-driven professional" has graced my inbox!

Listen friend, your CV is like a beige wallpaper - technically functional but puts everyone to sleep. Let's wake this thing up!

Your summary is 4 lines of nothing. "Experienced professional seeking opportunities" - WOW, groundbreaking! Every CV says this. Tell me what makes YOU different in 2 sentences max.

Work experience needs CPR:
- "Collaborated with teams" â†’ "Led cross-functional team of 8 to launch product 2 weeks ahead of schedule"
- "Improved processes" â†’ "Redesigned onboarding process, reducing new hire ramp-up time by 50%"

Your education section is longer than your achievements. Unless you're a recent grad, flip that ratio!

ðŸš€ The Fix:
1. Lead with impact, not duties
2. Numbers are your best friend
3. Show progression in your career
4. Cut the fluff, add the stuff that matters
5. Make it scannable - recruiters spend 6 seconds on each CV

You've got the experience, now make it SHINE! âœ¨`
                ];
                
                return roasts[Math.floor(Math.random() * roasts.length)];
            }

            getMockLinkedInRoast() {
                const linkedInRoasts = [
                    `ðŸ”¥ OH WOW, another "Passionate about leveraging synergies" headline!

Let me guess - your summary starts with "Results-driven professional" and ends with "seeking new opportunities"? Original!

Your experience section is a graveyard of corporate buzzwords:
â€¢ "Spearheaded initiatives" (what initiatives? be specific!)
â€¢ "Thought leadership in disruptive technologies" (this means nothing)
â€¢ "Cross-functional collaboration" (you talked to other people, congrats)

And can we discuss your skills endorsements? You've got "Leadership" with 5 endorsements from people who've never seen you lead anything.

ðŸŽ¯ The LinkedIn Reality Check:
- Your headline should say what you DO, not corporate fluff
- Use numbers in your experience ("increased sales by 40%" not "drove growth")
- Post actual content instead of reposting motivational quotes
- Your photo shouldn't look like a hostage situation

ðŸ’¡ Quick fixes:
- Write like a human, not a corporate robot
- Show real work examples
- Connect with people you actually know
- Stop saying you're "blessed" to announce job changes

Your profile has potential buried under corporate BS. Time to dig it out! ðŸš€`,

                    `ðŸŽ¯ Well hello there, "Innovative thought leader passionate about digital transformation"!

Your LinkedIn reads like it was written by a buzzword generator having an existential crisis.

Let's break down this masterpiece:
ðŸ“¸ Profile photo: Why do you look surprised to be there?
ðŸ·ï¸ Headline: "Experienced professional seeking opportunities" - along with 50 million others
ðŸ“ Summary: 3 paragraphs of nothing. "Passionate about excellence" tells me zilch

Your posts are even better:
- Reposted 47 "Monday Motivation" quotes this month
- Shared that story about the CEO who helps janitors (we've all seen it)
- "Agree? Thoughts?" on obvious statements

ðŸ”¥ But here's what's really killing your profile:
â€¢ No personality - you sound like every other LinkedIn zombie
â€¢ No specific achievements - "managed projects" means nothing
â€¢ Connections with random MLM people you've never met
â€¢ Endorsing people for skills you've never seen them use

ðŸ’¡ The Fix:
1. Write your headline like you're introducing yourself at a party
2. Share YOUR actual work, not recycled inspiration porn
3. Comment with real insights, not just "Great post!"
4. Connect with humans, not LinkedIn bots

You're a real person with real skills. Let that show! âœ¨`
                ];
                
                return linkedInRoasts[Math.floor(Math.random() * linkedInRoasts.length)];
            }

            showLoading() {
                this.loading.style.display = 'block';
                this.result.style.display = 'none';
                this.roastBtn.disabled = true;
            }

            showResult(content) {
                this.loading.style.display = 'none';
                this.result.style.display = 'block';
                this.result.classList.remove('error');
                this.resultTitle.textContent = 'ðŸŽ¯ The Roast';
                this.resultContent.textContent = content;
                this.roastBtn.disabled = false;
            }

            showError(message) {
                this.loading.style.display = 'none';
                this.result.style.display = 'block';
                this.result.classList.add('error');
                this.resultTitle.textContent = 'âŒ Error';
                this.resultContent.textContent = message;
                this.roastBtn.disabled = false;
            }
        }

        // Initialize the app
        document.addEventListener('DOMContentLoaded', () => {
            new CVRoastBot();
        });
    </script>
</body>
</html>